<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mango Festival Seat Selection</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 10px;
      background-color: #fffbe6;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #d9903b;
    }

    .layout {
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      position: relative;
    }

    .table-group {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      width: 100%;
    }

    .table {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .table-label {
      margin-bottom: 8px;
      font-weight: bold;
    }

    .seats {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 5px;
    }

    .seat {
      width: 40px;
      height: 40px;
      background-color: #9be69b;
      border: 2px solid #555;
      border-radius: 8px;
      text-align: center;
      line-height: 40px;
      font-size: 16px;
      cursor: pointer;
    }

    .seat.selected {
      background-color: #6dbbff;
    }

    .seat.booked {
      background-color: #e66;
      cursor: not-allowed;
    }

    .seat.final-selected {
      background-color: red;
      cursor: not-allowed;
    }

    .floor {
      flex-direction: row;
      flex-wrap: wrap;
    }

    .confirm {
      text-align: center;
      margin-top: 20px;
    }

    button {
      padding: 10px 20px;
      background-color: #ffa726;
      border: none;
      color: white;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #fb8c00;
    }

    .input-group {
      text-align: center;
      margin: 20px;
    }

    .input-group input {
      padding: 10px;
      font-size: 16px;
      margin-right: 10px;
    }

    .entrance {
      position: absolute;
      top: 50%;
      right: 0;
      transform: translateY(-50%);
      font-size: 40px;
      font-weight: bold;
      color: #d9903b;
      writing-mode: vertical-rl;
    }

    .serving-counter {
      position: absolute;
      top: 50%;
      left: 0;
      transform: translateY(-50%);
      font-size: 20px;
      font-weight: bold;
      color: #d9903b;
      writing-mode: vertical-rl;
    }

    .confirmation-message {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      color: #d9903b;
      margin-top: 50px;
    }

    .legend {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      font-size: 14px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      border: 1px solid #333;
    }
  </style>
</head>
<body>
<h2>üçã Mango Festival - Choose Your Seat</h2>

<!-- Primary Info Form -->
<div class="input-group">
  <label for="guestName">Primary Guest Name: </label>
  <input type="text" id="guestName" required />
</div>
<div class="input-group">
  <label for="guestPhone">Phone Number: </label>
  <input type="text" id="guestPhone" required />
</div>
<div class="input-group">
  <label for="guestEmail">Email: </label>
  <input type="email" id="guestEmail" required />
</div>

<div class="input-group">
  <label for="numPeople">Number of people attending: </label>
  <input type="number" id="numPeople" min="1" required />
  <button onclick="showSeats()">Submit</button>
</div>

<!-- Seat Selection Layout -->
<div class="layout" id="seatLayout" style="display:none;">
  <div class="serving-counter">SERVING COUNTER</div>
  <div class="entrance">ENTRANCE</div>
  <div class="table-group" id="roundTables">
    <div class="table">
      <div class="table-label">Round Table 1</div>
      <div class="seats">
        <div class="seat" data-seat="RT1-1">1</div>
        <div class="seat" data-seat="RT1-2">2</div>
        <div class="seat" data-seat="RT1-3">3</div>
      </div>
    </div>
    <div class="table">
      <div class="table-label">Round Table 2</div>
      <div class="seats">
        <div class="seat" data-seat="RT2-1">1</div>
        <div class="seat" data-seat="RT2-2">2</div>
        <div class="seat" data-seat="RT2-3">3</div>
      </div>
    </div>
  </div>

  <div class="table-group" id="squareTables">
    <div class="table">
      <div class="table-label">Square Table 1</div>
      <div class="seats">
        <div class="seat" data-seat="ST1-1">1</div>
        <div class="seat" data-seat="ST1-2">2</div>
      </div>
    </div>
    <div class="table">
      <div class="table-label">Square Table 2</div>
      <div class="seats">
        <div class="seat" data-seat="ST2-1">1</div>
        <div class="seat" data-seat="ST2-2">2</div>
      </div>
    </div>
    <div class="table">
      <div class="table-label">Square Table 3</div>
      <div class="seats">
        <div class="seat" data-seat="ST3-1">1</div>
        <div class="seat" data-seat="ST3-2">2</div>
      </div>
    </div>
  </div>

  <div class="table-group" id="floorSeating">
    <div class="table">
      <div class="table-label">Floor Seating</div>
      <div class="seats floor">
        <div class="seat" data-seat="FS-1">1</div>
        <div class="seat" data-seat="FS-2">2</div>
        <div class="seat" data-seat="FS-3">3</div>
        <div class="seat" data-seat="FS-4">4</div>
      </div>
    </div>
  </div>
</div>

<div class="confirm" id="confirmSelection">
  <button id="confirmBtn" onclick="confirmSelection()" disabled>Confirm Selection</button>
</div>

<div id="confirmationMessage" class="confirmation-message" style="display:none;">
  Seats Confirmed! Thank you for your selection.
</div>

<div class="legend">
  <div class="legend-item"><div class="legend-color" style="background-color: #e66;"></div>Booked</div>
  <div class="legend-item"><div class="legend-color" style="background-color: #9be69b;"></div>Available</div>
  <div class="legend-item"><div class="legend-color" style="background-color: #6dbbff;"></div>Selected</div>
</div>

<script>
  let seats = document.querySelectorAll(".seat");
  let numPeopleInput = document.getElementById("numPeople");
  let seatLayout = document.getElementById("seatLayout");
  let roundTables = document.getElementById("roundTables");
  let squareTables = document.getElementById("squareTables");
  let floorSeating = document.getElementById("floorSeating");
  let confirmationMessage = document.getElementById("confirmationMessage");
  let confirmBtn = document.getElementById("confirmBtn");

  let confirmedSeats = JSON.parse(localStorage.getItem('confirmedSeats')) || [];
  let numPeople = 0;

  function showSeats() {
    numPeople = parseInt(numPeopleInput.value);
    if (numPeople < 1) {
      alert("Please enter a valid number of people (1 or more).");
      return;
    }

    roundTables.style.display = "none";
    squareTables.style.display = "none";
    floorSeating.style.display = "none";

    if (numPeople === 1) {
      squareTables.style.display = "flex";
    } else if (numPeople > 2) {
      roundTables.style.display = "flex";
      squareTables.style.display = "flex";
      floorSeating.style.display = "flex";
    }

    seatLayout.style.display = "block";

    seats.forEach(seat => {
      seat.classList.remove("booked", "selected", "final-selected");
      seat.addEventListener("click", toggleSeatSelection);
    });
  }

  function toggleSeatSelection(event) {
    let seat = event.target;
    if (seat.classList.contains("booked") || seat.classList.contains("final-selected")) {
      return;
    }

    seat.classList.toggle("selected");
    checkSelection();
  }

  function checkSelection() {
    let selectedSeats = document.querySelectorAll(".seat.selected");
    if (selectedSeats.length === numPeople) {
      confirmBtn.disabled = false;
    } else {
      confirmBtn.disabled = true;
    }
  }

  function confirmSelection() {
    let selectedSeats = [];
    seats.forEach(seat => {
      if (seat.classList.contains("selected")) {
        seat.classList.add("final-selected");
        selectedSeats.push(seat.getAttribute("data-seat"));
        seat.classList.remove("selected");
        seat.classList.add("booked");
      }
    });

    if (selectedSeats.length === numPeople) {
      confirmedSeats = [...confirmedSeats, ...selectedSeats];
      localStorage.setItem('confirmedSeats', JSON.stringify(confirmedSeats));

      // Prepare the message to send via WhatsApp
      let guestName = document.getElementById('guestName').value;
      let guestPhone = document.getElementById('guestPhone').value;
      let guestEmail = document.getElementById('guestEmail').value;
      let seatDetails = selectedSeats.join(", ");
      
      let message = `Hello, I would like to confirm my seat reservation for the Mango Festival.\n\nName: ${guestName}\nPhone: ${guestPhone}\nEmail: ${guestEmail}\nSeats: ${seatDetails}`;
      
      // WhatsApp URL format
      let whatsappUrl = `https://wa.me/9853437595?text=${encodeURIComponent(message)}`;
      
      // Open WhatsApp link (user needs to send the message manually)
      window.open(whatsappUrl, '_blank');

      // Show confirmation message on the page
      confirmationMessage.style.display = "block";
      setTimeout(() => {
        window.location.reload();
      }, 3000);
    } else {
      alert(`Please select exactly ${numPeople} seat(s).`);
    }
  }
</script>
</body>
</html>
